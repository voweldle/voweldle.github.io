"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[439],{9439:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var l=a(5893),r=a(7294),s=a(3727),n=a.n(s);a(4619);var o=JSON.parse('{"game":{"id":1,"dayOffset":1,"boardState":[],"currentRowIndex":0,"status":"NOT_STARTED","answer":"","lastPlayed":"","lastCompleted":"","lastGenerated":""},"settings":{"hardMode":false,"darkMode":false,"colorblindMode":false},"stats":{"currentStreak":1,"maxStreak":1,"guesses":{},"winPercentage":0,"gamesPlayed":0,"gamesWon":0,"averageGuesses":0,"isOnStreak":false,"hasPlayed":false},"timestamp":0,"schemaVersion":"0.0.1"}');let c="vowel",i=e=>"AEIOU".includes(e);function u(){let e=(0,r.useRef)(null),[t,a]=(0,r.useState)(!1),[s,u]=(0,r.useState)(!1),[d,m]=(0,r.useState)([]),[g,f]=(0,r.useState)([]),[h,p]=(0,r.useState)(0),[S,w]=(0,r.useState)(o),[b,x]=(0,r.useState)(!1),[y,k]=(0,r.useState)(""),[N,E]=(0,r.useState)(0),[v,j]=(0,r.useState)([]),[O,I]=(0,r.useState)("QWERTYUIOPASDFGHJKLZXCVBNM".split("").reduce((e,t)=>(e[t]=i(t)?c:"none",e),{})),R=(0,r.useRef)(!1),C=(e,t)=>{let a=[...e];for(let e=a.length;e<t.length;e++)if(i(t[e]))a.push(t[e]);else break;return a};(0,r.useEffect)(()=>{let e=async()=>{let e=await fetch("/game_word_list.txt"),t=await e.text(),a=t.split("\n"),l=Math.floor(Math.random()*a.length),r=a[l].toUpperCase();k(r),E(r.length),R.current=!0,m(()=>(R.current=!1,C([],r))),w(e=>(e.game.boardState=[],e.game.answer=r,e.game.lastGenerated=new Date().toISOString(),e.game.status="IN_PROGRESS",e)),x(!0)};var t=localStorage.getItem("gameData");if(t){let a=Date.parse(JSON.parse(t).game.lastGenerated);if(new Date().getTime(),a<new Date().setHours(0,0,0,0))e();else{let e=JSON.parse(t);w(e);let a=e.game.answer;k(a);let l=e.game.boardState;f(Array(l.length).fill([])),p(l.length),l.map((e,t)=>G(e,t,a)),E(a.length),m(()=>(R.current=!1,C([],a))),x(!0)}}else e()},[]);let D=async e=>{let t=await fetch("/enable_word_list.txt"),a=await t.text(),l=a.split("\n");console.log(l);let r=l.map(e=>e.toLowerCase());return r.includes(e.toLowerCase())},P=e=>{"{enter}"===e?B("Enter"):"{backspaceSymbol}"===e?B("Backspace"):B(e)};function _(e,t){let a={...e};return t.forEach(e=>{i(e.letter)||("yellow"===a[e.letter]&&"green"===e.color?a[e.letter]="green":"none"!==a[e.letter]||(a[e.letter]=e.color))}),a}function T(e,t){let a={...e};return t.split("").forEach(e=>{a[e]="green"}),a}async function G(e,t,a){let l=e.split(""),r=A(l,e,a),s=D(e);await s?(f(e=>(e[t]=r,[...e])),I(e=>_(e,r)),r.every(e=>"green"===e.color)&&(u(!0),I(e=>T(e,a)))):f(e=>(e[t]=r.map(e=>({...e,color:"black"})),[...e]))}function A(e,t,a){return t===a?e.map(e=>({letter:e,color:"green"})):e.map((l,r)=>{if("AEIOU".includes(a[r]))return{letter:a[r],color:c};if(a[r]===l)return{letter:l,color:"green"};if(!a.includes(l))return{letter:l,color:"red"};{let s=a.split("").filter(e=>e===l).length,n=e.slice(0,r).filter(e=>e===l).length,o=a.split("").filter((e,a)=>e===l&&e===t[a]).length,c=a.split("").slice(0,r).filter((e,a)=>e===l&&e===t[a]).length;return n-c<s-o?{letter:l,color:"yellow"}:{letter:l,color:"red"}}})}(0,r.useEffect)(()=>{j(["green","red","yellow","none","vowel"].map(e=>({class:"key-".concat(e),buttons:Object.keys(O).filter(t=>O[t]===e).join(" ")})).filter(e=>""!==e.buttons))},[O]);let M=()=>{u(!1)};(0,r.useEffect)(()=>{b&&localStorage.setItem("gameData",JSON.stringify(S))},[S,b]);let B=async e=>{if("WIN"!==S.game.status&&!R.current){if("Backspace"===e)R.current=!0,m(e=>{let t=y.slice(0,e.length).split(""),a=e.length-1-t.reverse().findIndex(e=>!i(e)),l=e.slice(0,a);return R.current=!1,C(l,y)});else if("Enter"===e){if(d.length===N){R.current=!0;let e=d.join(""),t=D(e);w(t=>({...t,game:{...t.game,boardState:[...t.game.boardState,e]}}));let a=A(d,e,y);p(e=>e+1),await t?(f(e=>[...e,a]),m(()=>(R.current=!1,C([],y))),I(e=>_(e,a)),a.every(e=>"green"===e.color)&&(w(e=>({...e,game:{...e.game,lastCompleted:new Date().toISOString(),lastPlayed:new Date().toISOString(),status:"WIN"}})),I(e=>T(e,y)),u(!0))):(f(e=>[...e,a.map(e=>({...e,color:"black"}))]),m(()=>(R.current=!1,C([],y))),w(e=>({...e,game:{...e.game,lastPlayed:new Date().toISOString(),status:"IN_PROGRESS"}}))),w(e=>({...e,game:{...e.game,currentRowIndex:g.length}}))}else a(!0)}else d.length<N&&(R.current=!0,m(t=>(R.current=!1,C([...t,e],y))))}},J=(0,r.useCallback)(e=>{let{key:t}=e;if(/^[a-zA-Z]$/.test(t)){let e=t.toUpperCase();B(e)}else"Enter"===t?B("Enter"):"Backspace"===t&&B("Backspace")},[d]);return(0,r.useEffect)(()=>(document.addEventListener("keydown",J),()=>{document.removeEventListener("keydown",J)}),[J]),(0,l.jsxs)("div",{className:"keyboard-container",children:[(0,l.jsxs)("div",{className:"box-container",children:[g.map((e,t)=>(0,l.jsx)("div",{className:"row",children:e.map((e,t)=>(0,l.jsx)("div",{className:"box ".concat(e.color),children:" "===e.letter?"\xa0":e.letter},t))},t)),(0,l.jsx)("div",{className:"row",children:"IN_PROGRESS"===S.game.status?(0,l.jsx)(l.Fragment,{children:y.split("").map((e,t)=>{let a=i(e),r=t<d.length,s=r?d[t]:a?e:"\xa0";return(0,l.jsx)("div",{className:"box ".concat(a?c:""),children:s},t)})}):null})]}),(0,l.jsx)("div",{className:"virtual-keyboard",children:(0,l.jsx)(n(),{keyboardRef:t=>e.current=t,layout:{default:["Q W E R T Y U I O P","A S D F G H J K L","{enter} Z X C V B N M {backspaceSymbol}"]},display:{"{enter}":"ENTER","{backspaceSymbol}":"⌫"},onKeyPress:P,buttonTheme:v})}),(0,l.jsx)(function(e){let{message:s,timeout:n=3e3}=e;return(0,r.useEffect)(()=>{let e=setTimeout(()=>{a(!1)},n);return()=>clearTimeout(e)},[n]),t?(0,l.jsx)("div",{className:"dialog-box",children:(0,l.jsx)("div",{className:"message",children:s})}):null},{message:"Too few letters!",timeout:1e3}),s&&(0,l.jsx)("div",{className:"win-dialog-box",children:(0,l.jsxs)("div",{className:"message",children:[(0,l.jsx)("button",{className:"close-button",onClick:M,children:"✕"})," ",(0,l.jsxs)("p",{children:["You win! Attempts: ",h]})]})})]})}}}]);